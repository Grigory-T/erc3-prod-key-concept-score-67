================================================================================
STEP 5
================================================================================
Started: 2025-12-09 19:14:19

Step 5: Check permissions and team membership of the current user "6KR2_043" for the candidate projects to confirm that she is part of these projects and allowed to view her role.
Approach: For each project_id from Step 4, query the team_member table with exact matching on employee_id = "6KR2_043" and project_id = that project. Retrieve any matching rows and the associated role and time_slice. In parallel, retrieve the current user’s system roles and positions (if stored outside these tables) via a who_am_i or equivalent identity service to check for any additional permissions (for example, being a project lead or department leader). Since reading one’s own role on a project is generally allowed and there is no explicit restriction in the provided rules, mark access as allowed if a team_member entry exists for that project; otherwise mark as not a member. Output a list showing, for each candidate project, whether the user is a team member and what the team_member.role value is when present.
Expected Output: {"type":"object","properties":{"employee_id":{"type":"string"},"project_memberships":{"type":"array","items":{"type":"object","properties":{"project_id":{"type":"string"},"is_member":{"type":"boolean"},"role":{"type":["string","null"]},"time_slice":{"type":["number","null"]}},"required":["project_id","is_member"]}}},"required":["employee_id","project_memberships"]}
